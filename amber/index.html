<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AMBER</title>
  <link rel="icon" href="./images/amberSpider.ico" type="image/x-icon">
  <style>
    html { font-size: 10px; }
    *{ box-sizing:border-box; margin:0; padding:0; }
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
      line-height: 1.6; color:#222; background:#fff;
    }
    .page{ display:grid; grid-template-rows:auto auto 1fr auto; min-height:100vh; }

    /* ===== 顶部轮播（与原版一致，略微精简） ===== */
    header.slider{ justify-self:center; width:100%; }
    .slider{ width:100%; aspect-ratio:9.6/1; overflow:hidden; position:relative; }
    .slider-wrapper{ width:100%; height:100%; position:relative; }
    .slider-wrapper img{ width:100%; height:100%; object-fit:cover; display:block; }
    .slider-footer{ position:absolute; inset:auto 0 0 0; height:40px; background:rgba(36,31,33,.6); color:#fff; padding:2px 12px 0; display:flex; flex-direction:column; justify-content:space-between; }
    .slider-footer p{ font-size:15px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .slider-indicator{ list-style:none; display:flex; gap:6px; }
    .slider-indicator li{ width:6px; height:6px; border-radius:50%; background:#fff; opacity:.4; cursor:pointer; }
    .slider-indicator li.active{ opacity:1; transform:scale(1.05); }
    .toggle{ position:absolute; right:8px; top:5px; display:flex; gap:12px; }
    .toggle button{ width:30px; height:30px; border:none; border-radius:4px; background:rgba(255,255,255,.12); color:#fff; cursor:pointer; }
    .toggle button:hover{ background:rgba(255,255,255,.22); }

    /* ===== 导航 ===== */
    nav.navbar{ position:sticky; top:0; z-index:100; background:#CD853F; box-shadow:0 2px 6px rgba(0,0,0,.06); padding:0 24px; }
    .navbar ul{ display:grid; grid-auto-flow:column; gap:12rem; height:6rem; align-items:center; list-style:none; justify-content:center; overflow:auto hidden; }
    .navbar a{ color:#fff; text-decoration:none; font-size:16px; font-weight:600; padding:4px 0; transition:color .2s; }
    .navbar a:hover{ color:#FFD700; }
    .navbar a.active{ color:#FFD700; position:relative; }
    .navbar a.active::after{ content:''; position:absolute; left:0; bottom:-4px; width:100%; height:2px; background:#FFD700; border-radius:1px; }

    /* ===== 手机菜单 ===== */
    .mobile-menu{ display:none; padding:12px; background:#CD853F; }
    .mobile-menu select{ width:100%; font-size:16px; padding:8px; border-radius:4px; border:none; }

    /* ===== 主体 ===== */
    main.content-container{
      display:grid; grid-template-columns:1fr; gap:24px; padding:32px; max-width:1200px; width:100%; margin-inline:auto;
    }
    .content-section{
      display:none; grid-template-columns:1fr; gap:24px; align-content:start; opacity:0; pointer-events:none; transition:opacity .3s ease;
    }
    .content-section.show{ display:grid; }
    .content-section.fade-in{ opacity:1; pointer-events:auto; }
    .content-section.fade-out{ opacity:0; pointer-events:none; }

    .card{ background:#D7FFD7; border-radius:8px; padding:24px; display:grid; gap:12px; }
    .card h3{ font-size:20px; }
    .card p{ font-size:1.6rem; color:#555; }

    /* ===== 使用手册样式（INSTRUCTION 改造） ===== */
    .manual{
      display:grid; grid-template-columns: 280px 1fr; gap:24px;
    }
    .manual .toc{
      position:sticky; top:80px; align-self:start; background:#fff; border:1px solid #eee; border-radius:8px; padding:16px; max-height: calc(100vh - 120px); overflow:auto;
    }
    .manual .toc h4{ font-size:14px; color:#666; margin-bottom:8px; }
    .manual .toc a{ display:block; font-size:14px; color:#333; text-decoration:none; padding:4px 6px; border-radius:4px; }
    .manual .toc a:hover{ background:#f6f6f6; }
    .manual .toc a.active{ color:#0a7f2e; background:#e7f7ec; font-weight:600; }
    .manual .toc .toc-l2{ padding-left:12px; }
    .manual .toc .toc-l3{ padding-left:24px; }

    .manual .manual-body{
      background:#fff; border:1px solid #eee; border-radius:8px; padding:24px;
    }
    .manual .manual-body h1{ font-size:2.4rem; margin-bottom:8px; }
    .manual .manual-body .meta{ display:flex; gap:12px; flex-wrap:wrap; margin-bottom:16px; color:#666; font-size:1.3rem; }
    .badge{
      display:inline-flex; align-items:center; gap:6px; font-size:12px; padding:4px 8px; border-radius:999px; background:#f0f0f0; color:#333;
    }
    .badge.success{ background:#e7f7ec; color:#0a7f2e; }
    .badge.info{ background:#e7f0ff; color:#1f4ed8; }
    .badge.warn{ background:#fff7e6; color:#a15d00; }

    .manual .manual-body h2{ font-size:2rem; margin:24px 0 12px; }
    .manual .manual-body h3{ font-size:1.8rem; margin:18px 0 8px; }
    .manual .manual-body p, .manual .manual-body li{ font-size:1.5rem; color:#333; }
    .manual .manual-body ul, .manual .manual-body ol{ padding-left:16px; margin:8px 0 12px; }

    /* 代码块 */
    pre{ position:relative; background:#0b1020; color:#e6edf3; padding:14px 16px; border-radius:8px; overflow:auto; }
    pre code{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:13px; }
    .copy-btn{
      position:absolute; right:10px; top:10px; font-size:12px; border:none; padding:6px 8px; border-radius:6px; background:#233; color:#cde; cursor:pointer;
    }
    .copy-btn:hover{ background:#2c3e; }

    /* 平台 Tab */
    .tabs{ display:flex; gap:8px; border-bottom:1px solid #eee; margin-bottom:12px; }
    .tab-btn{
      appearance:none; border:none; background:#f1f1f1; color:#333; padding:6px 10px; border-radius:6px 6px 0 0; cursor:pointer; font-size:12px;
    }
    .tab-btn[aria-selected="true"]{ background:#fff; border:1px solid #eee; border-bottom-color:#fff; }
    .tab-panel{ display:none; }
    .tab-panel.active{ display:block; }

    /* Callouts */
    .callout{ border-left:4px solid #999; background:#f8f8f8; padding:12px 14px; border-radius:6px; margin:12px 0; }
    .callout.tip{ border-left-color:#0a7f2e; background:#e7f7ec; }
    .callout.warn{ border-left-color:#a15d00; background:#fff7e6; }
    .callout.info{ border-left-color:#1f4ed8; background:#e7f0ff; }

    /* 打印：仅打印手册正文 */
    @media print{
      header.slider, nav.navbar, .mobile-menu, footer.site-footer, #homeContainer, #publicationContainer, #downloadContainer, #exampleContainer, #datasetContainer, #teamContainer, #piContainer, #contactContainer { display:none !important; }
      #instructionContainer{ display:block !important; opacity:1 !important; }
      .manual{ grid-template-columns: 1fr; }
      .manual .toc{ display:none; }
      body{ background:#fff; }
    }

    /* 响应式 */
    @media (max-width: 1024px){
      .manual{ grid-template-columns: 1fr; }
      .manual .toc{ position:relative; top:auto; max-height:none; }
    }
    @media (max-width: 768px){
      .navbar{ display:none; }
      .mobile-menu{ display:block; }
      main.content-container{ padding:16px; }
      .manual .manual-body{ padding:16px; }
    }
  </style>
</head>
<body>
  <div class="page">

    <!-- ===== 轮播 ===== -->
    <header class="slider" role="region" aria-label="Hero carousel">
      <div class="slider-wrapper">
        <img src="./images/header/a01.png" alt="Slide: Bioinformatics" />
        <div class="slider-footer" id="sliderFooter" aria-live="polite">
          <p id="sliderTitle">Bioinformatics</p>
          <ul class="slider-indicator" role="tablist" aria-label="Carousel indicators">
            <li class="active" role="tab" aria-selected="true" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
          </ul>
          <div class="toggle">
            <button class="prev" aria-label="Previous slide" title="Previous">&lt;</button>
            <button class="next" aria-label="Next slide" title="Next">&gt;</button>
          </div>
        </div>
      </div>
    </header>

    <!-- ===== 顶部导航 ===== -->
    <nav class="navbar" aria-label="Primary">
      <ul>
        <li><a href="#homeContainer">HOME</a></li>
        <li><a href="#downloadContainer">DOWNLOAD</a></li>
        <li><a href="#instructionContainer">INSTRUCTION</a></li>
        <li><a href="#exampleContainer">EXAMPLE</a></li>
        <li><a href="#datasetContainer">DATASET</a></li>
        <li><a href="#publicationContainer">PUBLICATION</a></li>
        <li><a href="#contactContainer">CONTACT</a></li>
      </ul>
    </nav>

    <!-- 手机菜单 -->
    <div class="mobile-menu">
      <select id="mobileNav">
        <option value="">MENU</option>
        <option value="#homeContainer">HOME</option>
        <option value="#downloadContainer">DOWNLOAD</option>
        <option value="#instructionContainer">INSTRUCTION</option>
        <option value="#exampleContainer">EXAMPLE</option>
        <option value="#datasetContainer">DATASET</option>
        <option value="#publicationContainer">PUBLICATION</option>
        <option value="#contactContainer">CONTACT</option>
      </select>
    </div>

    <!-- ===== 主体 ===== -->
    <main class="content-container">

      <!-- 其他栏目（保持与你之前一致，可按需编辑） -->
      <section id="homeContainer" class="content-section show fade-in">
        <div class="card"><h3>NEWS</h3><p></p></div>
        <div class="card"><h3>With Purpose Unchanged, Our Dreams Set Sail</h3><p></p></div>
      </section>

      <!-- ===== 使用手册（新版 INSTRUCTION） ===== -->
      <section id="instructionContainer" class="content-section">
        <div class="manual">
          <!-- 左侧目录（自动生成） -->
          <aside class="toc" aria-label="Manual Table of Contents">
            <h4>使用手册目录</h4>
            <nav id="manualToc"></nav>
          </aside>

          <!-- 右侧正文 -->
          <article class="manual-body" id="manualBody">
            <header>
              <h1>AMBER 使用手册</h1>
              <div class="meta">
                <span class="badge info">版本：v1.0.0</span>
                <span class="badge">更新时间：2025-09-20</span>
                <span class="badge success">稳定</span>
              </div>
              <div class="callout tip">
                💡 小提示：目录、锚点与滚动高亮都是自动生成的。你只需维护下面的标题（H2/H3）与正文内容即可。
              </div>
            </header>

            <!-- 你只需按需编辑以下各节内容即可；目录会自动识别 h2 / h3 -->
            <section>
              <h2>1. 介绍</h2>
              <p>AMBER 是用于 <em>（在此简述你的软件核心功能/应用场景）</em> 的工具套件，支持跨平台运行，并提供命令行与可编程 API 两种使用方式。</p>
              <div class="callout info">
                ✅ 适用对象：研究者、工程师、学生；<br>
                ✅ 支持平台：Windows / macOS / Linux。
              </div>
            </section>

            <section>
              <h2>2. 安装</h2>
              <h3>2.1 系统要求</h3>
              <ul>
                <li>操作系统：Windows 10+/macOS 12+/Ubuntu 20.04+</li>
                <li>CPU/内存：≥ 2 核 / 8 GB RAM</li>
                <li>依赖：Python 3.10+ 或 Node.js 18+（按你的实现修改）</li>
              </ul>

              <h3>2.2 通过包管理器安装</h3>
              <!-- 平台命令 Tab 示例 -->
              <div class="tabs" role="tablist" aria-label="Install Tabs">
                <button class="tab-btn" role="tab" aria-selected="true" data-tab="win">Windows (PowerShell)</button>
                <button class="tab-btn" role="tab" aria-selected="false" data-tab="mac">macOS (zsh)</button>
                <button class="tab-btn" role="tab" aria-selected="false" data-tab="linux">Linux (bash)</button>
              </div>
              <div id="tab-panels-install">
                <div class="tab-panel active" data-panel="win" role="tabpanel">
                  <pre><button class="copy-btn" data-copy>复制</button><code>winget install YourOrg.AMBER</code></pre>
                </div>
                <div class="tab-panel" data-panel="mac" role="tabpanel">
                  <pre><button class="copy-btn" data-copy>复制</button><code>brew tap yourorg/tap
brew install amber</code></pre>
                </div>
                <div class="tab-panel" data-panel="linux" role="tabpanel">
                  <pre><button class="copy-btn" data-copy>复制</button><code>curl -fsSL https://your.domain/install.sh | bash</code></pre>
                </div>
              </div>

              <h3>2.3 从源码构建</h3>
              <pre><button class="copy-btn" data-copy>复制</button><code>git clone https://your.domain/amber.git
cd amber
make build  # 或者: npm i && npm run build / pip install -e .</code></pre>
            </section>

            <section>
              <h2>3. 快速开始</h2>
              <h3>3.1 运行第一个任务</h3>
              <pre><button class="copy-btn" data-copy>复制</button><code>amber run --input samples/demo.fastq --out results/demo --threads 8</code></pre>
              <div class="callout tip">如果你只有一台双核笔记本，把 <code>--threads</code> 设为 2~4 即可。</div>

              <h3>3.2 最小配置文件</h3>
              <pre><button class="copy-btn" data-copy>复制</button><code># config.yaml
input: samples/demo.fastq
output_dir: results/demo
threads: 8
modes:
  - align
  - call
  - report</code></pre>
            </section>

            <section>
              <h2>4. 命令行选项</h2>
              <h3>4.1 常用参数</h3>
              <ul>
                <li><code>--input &lt;path&gt;</code>：输入文件路径（必需）。</li>
                <li><code>--out &lt;dir&gt;</code>：输出目录（默认 <code>./results</code>）。</li>
                <li><code>--threads &lt;n&gt;</code>：并行线程数（默认根据 CPU 自动）。</li>
                <li><code>--mode &lt;name&gt;</code>：运行模式（<code>align</code>、<code>call</code>、<code>report</code>）。</li>
                <li><code>--config &lt;file&gt;</code>：从 YAML 配置加载参数。</li>
              </ul>

              <h3>4.2 示例：组合参数</h3>
              <pre><button class="copy-btn" data-copy>复制</button><code>amber run \
  --input data/sample1.fastq \
  --out results/sample1 \
  --threads 12 \
  --mode align,call,report</code></pre>
            </section>

            <section>
              <h2>5. 输出与日志</h2>
              <ul>
                <li><code>logs/amber.log</code>：完整日志。</li>
                <li><code>report/index.html</code>：交互式报告。</li>
                <li><code>metrics.json</code>：关键指标汇总。</li>
              </ul>
              <div class="callout info">建议把 <code>results/</code> 设置到 SSD 盘以提升 I/O 性能。</div>
            </section>

            <section>
              <h2>6. 常见问题</h2>
              <h3>6.1 安装失败</h3>
              <p>请检查网络与包管理器源是否可用；或改用源码构建。</p>
              <h3>6.2 性能不佳</h3>
              <p>减少并发、关闭杀毒实时扫描、或把临时目录放到本地 SSD。</p>
            </section>

            <section>
              <h2>7. 反馈与支持</h2>
              <p>提交 Issue：<em>（替换为你的邮箱/Git 仓库/工单系统）</em></p>
            </section>
          </article>
        </div>
      </section>

      <!-- 其它栏目（保持） -->
      <section id="downloadContainer" class="content-section">
        <div class="card"><h3>Software</h3><p>……</p></div>
        <div class="card"><h3>Toolbox</h3><p>……</p></div>
        <div class="card"><h3>Dataset</h3><p>……</p></div>
      </section>

      <section id="exampleContainer" class="content-section">
        <div class="card"><h3>Software</h3><p>……</p></div>
        <div class="card"><h3>Toolbox</h3><p>……</p></div>
        <div class="card"><h3>Dataset</h3><p>……</p></div>
      </section>

      <section id="datasetContainer" class="content-section">
        <div class="card"><h3>Software</h3><p>……</p></div>
        <div class="card"><h3>Toolbox</h3><p>……</p></div>
        <div class="card"><h3>Dataset</h3><p>……</p></div>
      </section>

      <section id="publicationContainer" class="content-section">
        <div class="card"><h3>Articles</h3><p>……</p></div>
      </section>

      <section id="contactContainer" class="content-section">
        <div class="card"><h3>Contact</h3><p>Email: </p></div>
        <div class="card"><h3>Location</h3><p>Address: No. 519, Kunzhou Road, Xishan District, Kunming City, Yunnan Province, China</p><p>Postal Code: 650118</p></div>
      </section>
    </main>

    <footer class="site-footer">
      <p>&copy; 2025 Guodong Lab. All rights reserved.</p>
    </footer>
  </div>

  <!-- ===== JS ===== -->
  <script>
    /* ========= 轮播（原思路增强版） ========= */
    const slides = [
      { url:'./images/header/a01.png', title:'Bioinformatics', color:'rgba(36,31,33,.6)', alt:'Bioinformatics' },
      { url:'./images/header/a02.png', title:'Machine Learning', color:'rgba(43,35,26,.6)', alt:'Machine Learning' },
      { url:'./images/header/a03.png', title:'Deep Learning & Artificial Intelligence', color:'rgba(36,31,33,.6)', alt:'Deep Learning & AI' },
      { url:'./images/header/a04.png', title:'Phylogenetic Analysis', color:'rgba(43,35,26,.6)', alt:'Phylogenetic Analysis' },
      { url:'./images/header/a05.png', title:'Machine Unlearning', color:'rgba(36,31,33,.6)', alt:'Machine Unlearning' },
      { url:'./images/header/a06.png', title:'Cancer Bioinformatics', color:'rgba(43,35,26,.6)', alt:'Cancer Bioinformatics' },
    ];
    const sliderEl = document.querySelector('.slider');
    const imgEl = document.querySelector('.slider-wrapper img');
    const titleEl = document.getElementById('sliderTitle');
    const footerEl = document.getElementById('sliderFooter');
    const nextBtn = document.querySelector('.next');
    const prevBtn = document.querySelector('.prev');
    const dots = Array.from(document.querySelectorAll('.slider-indicator li'));
    let idx=0, autoplayId=null; const AUTOPLAY=3000;
    function show(i){ idx=(i+slides.length)%slides.length; const s=slides[idx];
      imgEl.src=s.url; imgEl.alt='Slide: '+(s.alt||s.title); titleEl.textContent=s.title; footerEl.style.backgroundColor=s.color;
      document.querySelector('.slider-indicator li.active')?.classList.remove('active'); dots[idx]?.classList.add('active');
      dots.forEach((d,k)=>d.setAttribute('aria-selected',k===idx?'true':'false'));
    }
    function next(){ show(idx+1); } function prev(){ show(idx-1); }
    function start(){ stop(); autoplayId=setInterval(next,AUTOPLAY); }
    function stop(){ if(autoplayId){ clearInterval(autoplayId); autoplayId=null; } }
    function interacted(){ stop(); start(); }
    nextBtn.addEventListener('click', ()=>{ next(); interacted(); });
    prevBtn.addEventListener('click', ()=>{ prev(); interacted(); });
    dots.forEach((d,i)=>{ d.addEventListener('click', ()=>{ show(i); interacted(); }); d.addEventListener('keydown',e=>{ if(['Enter',' '].includes(e.key)){ e.preventDefault(); show(i); interacted(); } })});
    sliderEl.addEventListener('mouseenter', stop); sliderEl.addEventListener('mouseleave', start);
    let sx=0; sliderEl.addEventListener('touchstart',e=>{ sx=e.changedTouches[0].clientX; },{passive:true});
    sliderEl.addEventListener('touchend',e=>{ const dx=e.changedTouches[0].clientX-sx; if(Math.abs(dx)>40){ dx<0?next():prev(); interacted(); } },{passive:true});
    document.addEventListener('visibilitychange',()=>{ document.hidden?stop():start(); });
    show(0); start();

    /* ========= 路由切换 ========= */
    const navLinks=document.querySelectorAll('.navbar a');
    const sections=document.querySelectorAll('.content-section');
    const mobileSelect=document.getElementById('mobileNav');
    function switchTo(id){
      const cur=document.querySelector('.content-section.show');
      const tar=document.getElementById(id);
      if(!tar||cur===tar) return;
      cur?.classList.remove('fade-in'); cur?.classList.add('fade-out');
      setTimeout(()=>{ cur?.classList.remove('fade-out','show'); tar.classList.add('show'); setTimeout(()=>tar.classList.add('fade-in'),16); },180);
      document.querySelector('.navbar a.active')?.classList.remove('active');
      document.querySelector(`.navbar a[href="#${id}"]`)?.classList.add('active');
      if(mobileSelect && mobileSelect.value!==`#${id}`) mobileSelect.value=`#${id}`;
    }
    navLinks.forEach(a=>a.addEventListener('click',e=>{ e.preventDefault(); const id=a.getAttribute('href').slice(1); history.pushState({section:id},'',`#${id}`); switchTo(id); }));
    mobileSelect.addEventListener('change',function(){ if(!this.value) return; const id=this.value.slice(1); history.pushState({section:id},'',`#${id}`); switchTo(id); });
    function initByHash(){ const h=location.hash.slice(1)||'homeContainer';
      sections.forEach(s=>s.classList.remove('show','fade-in','fade-out'));
      document.querySelectorAll('.navbar a').forEach(a=>a.classList.remove('active'));
      document.querySelector(`.navbar a[href="#${h}"]`)?.classList.add('active');
      document.getElementById(h)?.classList.add('show','fade-in');
      if(mobileSelect) mobileSelect.value=`#${h}`;
    }
    window.addEventListener('load', initByHash);
    window.addEventListener('popstate', ()=>{ const h=location.hash.slice(1)||'homeContainer'; switchTo(h); });

    /* ========= 使用手册：目录自动生成 / 滚动高亮 / 复制按钮 / Tabs ========= */
    (function manualEnhance(){
      const body = document.getElementById('manualBody');
      if(!body) return;

      // 1) 为 h2/h3 自动生成 id
      const headings = body.querySelectorAll('h2, h3');
      const slugMap = new Map();
      function slugify(text){
        const base = text.trim().toLowerCase().replace(/[^\u4e00-\u9fa5\w\s\-]+/g,'').replace(/\s+/g,'-');
        if(!slugMap.has(base)) { slugMap.set(base, 0); return base; }
        const n = slugMap.get(base)+1; slugMap.set(base,n); return `${base}-${n}`;
      }
      headings.forEach(h=>{
        if(!h.id){ h.id = slugify(h.textContent || 'section'); }
      });

      // 2) 构建 TOC
      const toc = document.getElementById('manualToc');
      const frag = document.createDocumentFragment();
      headings.forEach(h=>{
        if(!(h.tagName==='H2' || h.tagName==='H3')) return;
        const a=document.createElement('a');
        a.href = `#${h.id}`;
        a.textContent = h.textContent;
        a.className = h.tagName==='H2' ? 'toc-l2' : 'toc-l3';
        a.addEventListener('click', (e)=>{ e.preventDefault(); document.getElementById(h.id)?.scrollIntoView({behavior:'smooth', block:'start'}); history.pushState(null,'',`#${h.id}`); });
        frag.appendChild(a);
      });
      toc.innerHTML = ''; toc.appendChild(frag);

      // 3) 滚动高亮（scroll spy）
      const tocLinks = Array.from(toc.querySelectorAll('a'));
      const observer = new IntersectionObserver((entries)=>{
        entries.forEach(entry=>{
          const id = entry.target.id;
          const link = tocLinks.find(a=>a.getAttribute('href')===`#${id}`);
          if(!link) return;
          if(entry.isIntersecting){
            tocLinks.forEach(n=>n.classList.remove('active'));
            link.classList.add('active');
          }
        });
      }, { rootMargin: '0px 0px -70% 0px', threshold: 0.1 });
      headings.forEach(h => observer.observe(h));

      // 4) 代码块复制按钮
      body.querySelectorAll('pre .copy-btn[data-copy]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const pre = btn.closest('pre'); const code = pre?.querySelector('code')?.innerText || '';
          try{
            await navigator.clipboard.writeText(code);
            const old = btn.textContent; btn.textContent='已复制 ✔️'; setTimeout(()=>btn.textContent=old,1200);
          }catch(err){ btn.textContent='失败 ❗'; setTimeout(()=>btn.textContent='复制',1200); }
        });
      });

      // 5) 平台 Tab 切换
      function handleTabs(root){
        const tabBtns = root.querySelectorAll('.tab-btn');
        const panels = root.parentElement.querySelectorAll('.tab-panel');
        tabBtns.forEach(btn=>{
          btn.addEventListener('click', ()=>{
            const target = btn.dataset.tab;
            tabBtns.forEach(b=>b.setAttribute('aria-selected', String(b===btn)));
            panels.forEach(p=>p.classList.toggle('active', p.dataset.panel===target));
          });
        });
      }
      document.querySelectorAll('.tabs').forEach(handleTabs);

      // 6) 若 URL 含有手册内的锚点，进入后平滑滚动定位
      if(location.hash){
        const el = document.getElementById(location.hash.slice(1));
        el && setTimeout(()=>el.scrollIntoView({behavior:'smooth', block:'start'}), 200);
      }
    })();
  </script>
</body>
</html>
