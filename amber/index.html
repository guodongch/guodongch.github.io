<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AMBER</title>
  <link rel="icon" href="./images/amberSpider.ico" type="image/x-icon">
  <style>
    html { font-size: 10px; }
    *{ box-sizing:border-box; margin:0; padding:0; }
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
      line-height: 1.6; color:#222; background:#fff;
    }
    .page{ display:grid; grid-template-rows:auto auto 1fr auto; min-height:100vh; }

    /* ===== 轮播 ===== */
    header.slider{ justify-self:center; width:100%; }
    .slider{ width:100%; aspect-ratio:9.6/1; overflow:hidden; position:relative; }
    .slider-wrapper{ width:100%; height:100%; position:relative; }
    .slider-wrapper img{ width:100%; height:100%; object-fit:cover; display:block; }
    .slider-footer{ position:absolute; inset:auto 0 0 0; height:40px; background:rgba(36,31,33,.6); color:#fff; padding:2px 12px 0; display:flex; flex-direction:column; justify-content:space-between; }
    .slider-footer p{ font-size:15px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .slider-indicator{ list-style:none; display:flex; gap:6px; }
    .slider-indicator li{ width:6px; height:6px; border-radius:50%; background:#fff; opacity:.4; cursor:pointer; }
    .slider-indicator li.active{ opacity:1; transform:scale(1.05); }
    .toggle{ position:absolute; right:8px; top:5px; display:flex; gap:12px; }
    .toggle button{ width:30px; height:30px; border:none; border-radius:4px; background:rgba(255,255,255,.12); color:#fff; cursor:pointer; }
    .toggle button:hover{ background:rgba(255,255,255,.22); }

    /* ===== 顶部导航 ===== */
    nav.navbar{ position:sticky; top:0; z-index:100; background:#CD853F; box-shadow:0 2px 6px rgba(0,0,0,.06); padding:0 24px; }
    .navbar ul{ display:grid; grid-auto-flow:column; gap:12rem; height:6rem; align-items:center; list-style:none; justify-content:center; overflow:auto hidden; }
    .navbar a{ color:#fff; text-decoration:none; font-size:16px; font-weight:600; padding:4px 0; transition:color .2s; }
    .navbar a:hover{ color:#FFD700; }
    .navbar a.active{ color:#FFD700; position:relative; }
    .navbar a.active::after{ content:''; position:absolute; left:0; bottom:-4px; width:100%; height:2px; background:#FFD700; border-radius:1px; }

    /* ===== 手机菜单 ===== */
    .mobile-menu{ display:none; padding:12px; background:#CD853F; }
    .mobile-menu select{ width:100%; font-size:16px; padding:8px; border-radius:4px; border:none; }

    /* ===== 主体 ===== */
    main.content-container{
      display:grid; grid-template-columns:1fr; gap:24px; padding:32px; max-width:1200px; width:100%; margin-inline:auto;
    }
    .content-section{
      display:none; grid-template-columns:1fr; gap:24px; align-content:start; opacity:0; pointer-events:none; transition:opacity .3s ease;
    }
    .content-section.show{ display:grid; }
    .content-section.fade-in{ opacity:1; pointer-events:auto; }
    .content-section.fade-out{ opacity:0; pointer-events:none; }

    .card{ background:#D7FFD7; border-radius:8px; padding:24px; display:grid; gap:12px; }
    .card h3{ font-size:20px; }
    .card p{ font-size:1.6rem; color:#555; }

    /* ===== GUI 使用手册样式 ===== */
    .manual{
      display:grid; grid-template-columns: 280px 1fr; gap:24px;
    }
    .manual .toc{
      position:sticky; top:80px; align-self:start; background:#fff; border:1px solid #eee; border-radius:8px; padding:16px; max-height: calc(100vh - 120px); overflow:auto;
    }
    .manual .toc h4{ font-size:14px; color:#666; margin-bottom:8px; }
    .manual .toc a{ display:block; font-size:14px; color:#333; text-decoration:none; padding:4px 6px; border-radius:4px; }
    .manual .toc a:hover{ background:#f6f6f6; }
    .manual .toc a.active{ color:#0a7f2e; background:#e7f7ec; font-weight:600; }
    .manual .toc .toc-l2{ padding-left:12px; }
    .manual .toc .toc-l3{ padding-left:24px; }

    .manual .manual-body{
      background:#fff; border:1px solid #eee; border-radius:8px; padding:24px;
    }
    .manual .manual-body h1{ font-size:2.4rem; margin-bottom:8px; }
    .manual .manual-body .meta{ display:flex; gap:12px; flex-wrap:wrap; margin-bottom:16px; color:#666; font-size:1.3rem; }
    .badge{
      display:inline-flex; align-items:center; gap:6px; font-size:12px; padding:4px 8px; border-radius:999px; background:#f0f0f0; color:#333;
    }
    .badge.success{ background:#e7f7ec; color:#0a7f2e; }
    .badge.info{ background:#e7f0ff; color:#1f4ed8; }

    .manual .manual-body h2{ font-size:2rem; margin:24px 0 12px; }
    .manual .manual-body h3{ font-size:1.8rem; margin:18px 0 8px; }
    .manual .manual-body p, .manual .manual-body li{ font-size:1.5rem; color:#333; }
    .manual .manual-body ul, .manual .manual-body ol{ padding-left:16px; margin:8px 0 12px; }
    .callout{ border-left:4px solid #999; background:#f8f8f8; padding:12px 14px; border-radius:6px; margin:12px 0; }
    .callout.tip{ border-left-color:#0a7f2e; background:#e7f7ec; }
    .callout.warn{ border-left-color:#a15d00; background:#fff7e6; }
    .callout.info{ border-left-color:#1f4ed8; background:#e7f0ff; }

    /* 步骤卡片 */
    .steps{ display:grid; gap:14px; }
    .step{
      border:1px solid #e8e8e8; border-radius:10px; padding:14px 16px; background:#fafafa;
      display:grid; gap:8px;
    }
    .step-header{ display:flex; align-items:center; gap:10px; }
    .step-num{
      width:2.5rem; height:2.5rem; border-radius:50%; background:#0a7f2e; color:#fff; display:inline-flex; align-items:center; justify-content:center; font-weight:700; font-size:1.5rem;
      flex:0 0 auto;
    }
    .step-title{ font-weight:700; font-size: 1.5rem;}
    .step-body img{ border:1px solid #eee; border-radius:8px; max-width:100%; height:auto; cursor:zoom-in; }
    .step-actions{ display:flex; gap:8px; flex-wrap:wrap; }
    .btn{
      border:1px solid #ddd; background:#fff; color:#333; padding:6px 10px; border-radius:6px; cursor:pointer; font-size:12px;
    }
    .btn:hover{ background:#f6f6f6; }

    /* 图注 */
    figure{ margin:0; }
    figcaption{ font-size:12px; color:#666; margin-top:6px; }

    /* 两栏说明表 */
    .kv{
      width:100%; border-collapse:collapse; font-size:14px; margin-top:8px;
    }
    .kv th, .kv td{ border:1px solid #eee; padding:8px 10px; vertical-align:top; }
    .kv th{ width:200px; background:#fafafa; text-align:left; }

    /* 快捷键表 */
    .kbd{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background:#f1f1f1; border:1px solid #e2e2e2; border-bottom-width:2px; padding:2px 6px; border-radius:6px; font-size:12px; }

    /* FAQ 折叠 */
    .accordion{ border:1px solid #eee; border-radius:8px; overflow:hidden; }
    .ac-item + .ac-item{ border-top:1px solid #eee; }
    .ac-head{ width:100%; text-align:left; background:#fafafa; border:none; padding:12px 14px; font-weight:600; cursor:pointer; }
    .ac-body{ display:none; padding:12px 14px; background:#fff; }
    .ac-item.open .ac-body{ display:block; }

    /* 灯箱 */
    .lightbox{ position:fixed; inset:0; background: rgba(0,0,0,.75); display:none; align-items:center; justify-content:center; z-index:9999; }
    .lightbox.open{ display:flex; }
    .lightbox img{ max-width: min(96vw, 1400px); max-height: 92vh; border-radius:8px; box-shadow:0 10px 30px rgba(0,0,0,.5); }
    .lightbox .close{ position:fixed; top:18px; right:22px; color:#fff; font-size:28px; cursor:pointer; }

    /* 打印：仅打印手册正文 */
    @media print{
      header.slider, nav.navbar, .mobile-menu, footer.site-footer, #homeContainer, #publicationContainer, #downloadContainer, #exampleContainer, #datasetContainer, #teamContainer, #piContainer, #contactContainer { display:none !important; }
      #howtouseContainer{ display:block !important; opacity:1 !important; }
      .manual{ grid-template-columns: 1fr; }
      .manual .toc{ display:none; }
      body{ background:#fff; }
    }

    /* 响应式 */
    @media (max-width: 1024px){
      .manual{ grid-template-columns: 1fr; }
      .manual .toc{ position:relative; top:auto; max-height:none; }
    }
    @media (max-width: 768px){
      .navbar{ display:none; }
      .mobile-menu{ display:block; }
      main.content-container{ padding:16px; }
      .manual .manual-body{ padding:16px; }
    }

    @media (prefers-reduced-motion: reduce){
      * { animation:none !important; transition:none !important; }
    }


    /* === 全局滚动条样式（Chromium/Edge/Safari） === */
    ::-webkit-scrollbar {
      width: 1.2rem;            /* 右侧滚动条宽度 */
      height: 1.2rem;           /* 底部滚动条高度（如出现） */
    }
    ::-webkit-scrollbar-track {
      background: transparent; /* 轨道透明更干净 */
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(205, 133, 63, 0.5);   /* CD853F 半透明 */
      border: 0.1rem solid transparent;         /* 造“内边距”空隙 */
      border-radius: 0.6rem;
      background-clip: content-box;   
    }
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(205, 133, 63, 1);
      border: 0.1rem solid transparent;
      background-clip: content-box;
    }



    /* （可选）仅在手册区域自定义，而不是全局：把上面选择器改成这样 */
    /* .manual .manual-body, .manual .toc { scrollbar-width: thin; }
    .manual .manual-body::-webkit-scrollbar,
    .manual .toc::-webkit-scrollbar { width: 12px; }
    .manual .manual-body::-webkit-scrollbar-thumb,
    .manual .toc::-webkit-scrollbar-thumb { background: rgba(205,133,63,.5); border-radius: 8px; } */


    /* （可选）暗色模式适配 */
    /* @media (prefers-color-scheme: dark) {
      ::-webkit-scrollbar-thumb { background: rgba(205,133,63,.7); }
      * { scrollbar-color: rgba(205,133,63,.9) transparent; }
      
    } */


    /* 平滑滚动（目录/锚点更顺滑） */
    html { scroll-behavior: smooth; }

    /* 避开吸顶导航：目录跳转时标题不被顶住 */
    .manual .manual-body h2,
    .manual .manual-body h3 {
      scroll-margin-top: 7rem; /* 6rem 导航 + 1rem 一点间距 */
    }

    /* 统一：手册正文与步骤里的图片，默认不再铺满整行 */
    .manual .manual-body figure { 
      display:flex; flex-direction:column; align-items:center; 
    }
    .manual .manual-body figure img,
    .manual .manual-body .step-body img {
      width: auto;                         /* 关键：不要强行 100% */
      max-width: min(100%, 900px);         /* 默认上限 900px，且不超过容器 */
      max-height: 70vh;                    /* 竖屏截图也不会太高 */
      object-fit: contain;                 /* 等比缩放不变形 */
      border: 1px solid #eee;
      border-radius: 8px;
      box-shadow: 0 4px 14px rgba(0,0,0,.06);
    }

    /* 移动端仍然允许全宽展示（屏幕窄，小图全宽没问题） */
    @media (max-width: 768px){
      .manual .manual-body figure img,
      .manual .manual-body .step-body img {
        max-width: 100%;
        max-height: 62vh;
      }
    }

    /* 常用尺寸工具类：按需加到 <img> 上精细控制 */
    .img-sm   { max-width: 520px !important; }
    .img-md   { max-width: 720px !important; }
    .img-lg   { max-width: 960px !important; }
    .img-full { max-width: 100% !important; width: 100% !important; } /* 真全宽 */

    /* 多图并排（可选）：把多张图放到同一个 .figure-row 容器里 */
    .figure-row{
      display:grid; gap:12px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      align-items:start;
    }
    .figure-row img{ width:100%; height:auto; max-height: 50vh; object-fit: contain; }

    p {
      margin-block: 1rem 0.5rem;          /* 相当于 上、下 */
      /* 单独控制时： */
      /* margin-block-start: 0.5rem; */   /* 段前 */
      /* margin-block-end: 1rem; */       /* 段后 */
    }

  </style>
</head>
<body>
  <div class="page">

    <!-- ===== 轮播 ===== -->
    <header class="slider" role="region" aria-label="Hero carousel">
      <div class="slider-wrapper">
        <img src="./images/header/a01.png" alt="Slide: Phylogenetic Analysis" />
        <div class="slider-footer" id="sliderFooter" aria-live="polite">
          <p id="sliderTitle">Phylogenetic Analysis</p>
          <ul class="slider-indicator" role="tablist" aria-label="Carousel indicators">
            <li class="active" role="tab" aria-selected="true" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
            <li role="tab" aria-selected="false" tabindex="0"></li>
          </ul>
          <div class="toggle">
            <button class="prev" aria-label="Previous slide" title="Previous">&lt;</button>
            <button class="next" aria-label="Next slide" title="Next">&gt;</button>
          </div>
        </div>
      </div>
    </header>

    <!-- ===== 顶部导航 ===== -->
    <nav class="navbar" aria-label="Primary">
      <ul>
        <li><a href="#homeContainer">HOME</a></li>
        <li><a href="#downloadContainer">DOWNLOAD</a></li>
        <li><a href="#howtouseContainer">HOW TO USE</a></li>
        <li><a href="#exampleContainer">EXAMPLE</a></li>
        <li><a href="#datasetContainer">DATASET</a></li>
        <li><a href="#publicationContainer">PUBLICATION</a></li>
        <li><a href="#contactContainer">CONTACT</a></li>
      </ul>
    </nav>

    <!-- 手机菜单 -->
    <div class="mobile-menu">
      <select id="mobileNav">
        <option value="">MENU</option>
        <option value="#homeContainer">HOME</option>
        <option value="#downloadContainer">DOWNLOAD</option>
        <option value="#howtouseContainer">HOW TO USE</option>
        <option value="#exampleContainer">EXAMPLE</option>
        <option value="#datasetContainer">DATASET</option>
        <option value="#publicationContainer">PUBLICATION</option>
        <option value="#contactContainer">CONTACT</option>
      </select>
    </div>

    <!-- ===== 主体 ===== -->
    <main class="content-container">

      <!-- 其他栏目（可按需编辑） -->
      <section id="homeContainer" class="content-section show fade-in">
        <div class="card"><h3>AMBER: An Advanced Molecular Biology Evolution Research Software</h3><p></p></div>
        <div class="card"><h3>With Purpose Unchanged, Our Dreams Set Sail</h3><p></p></div>
      </section>

      <!-- ===== GUI Table of Contents ===== -->
      <section id="howtouseContainer" class="content-section">
        <div class="manual">
          <!-- 目录（自动生成） -->
          <aside class="toc" aria-label="Manual Table of Contents">
            <h4>Table of Contents</h4>
            <nav id="manualToc"></nav>
          </aside>

          <!-- 正文 -->
          <article class="manual-body" id="manualBody">
            <header>
              <h1>AMBER Usage</h1>
              <div class="meta">
                <span class="badge info">Version: 0.5.5+</span>
                <span class="badge">Last updated: 2025-09-21</span>
                <span class="badge success">GUI</span>
              </div>
              <div class="callout tip">Feature overview and usage instructions for AMBER-related components</div>
            </header>

            <!-- 1. Introduction -->
            <section>
              <h2>1. Introduction</h2>
              <p>Key analysis features include: Phylogenetic Analysis, Evolutionary Analysis, Gene Set Enrichment Analysis (GSEA). The Toolbox also includes DIAMOND. </p>
              <figure>
                <img src="./images/howtouse/introduction.png" alt="分析功能总览示意图，可替换为真实截图" data-lightbox>
                <figcaption>Figure: Introduction.</figcaption>
              </figure>
              <table class="kv">
                <tr><th>Phylogenetic Analysis</th><td>The analysis features include data collection, sequence alignment, low-quality sequence trimming, model selection, partitioning scheme setup, phylogenetic reconstruction, statistical analysis, as well as sequence and tree visualization.</td></tr>
                <tr><th>Evolutionary Analysis</th><td>The analysis features include molecular evolutionary analysis, population genetics analyses, community ecology diversity analyses, and related visualizations.</td></tr>
                <tr><th>Gene Set Enrichment Analysis</th><td>GSEA features include GO and KEGG pathway enrichment, pre-ranked GSEA, single sample GSEA, Gene Set Variation Analysis (GSVA) and so on. </td></tr>
                <tr><th>Toolbox</th><td>DIAMOND </td></tr>
              </table>
            </section>

            <!-- 2. 快速开始（步骤卡片） -->
            <section>
              <h2>2. Phylogenetic Analysis</h2>
              <div class="steps">
                <div class="step">
                  <div class="step-header">
                    <!-- <span class="step-num">1</span> -->
                    <span class="step-title">The main process of phylogenetic analysis</span>
                  </div>
                  <div class="step-body">
                    <p>Phylogenetic analysis involves multiple steps. 
                      First, sequence data (such as gene sequences, protein sequences, or genome sequences) must be collected and organized. 
                      Next, a Multiple Sequence Alignment (MSA) is performed. Once the alignment is accurate, low-quality regions are identified and processed. 
                      The sequences are then concatenated for further analysis. 
                      After that, an appropriate evolutionary model is selected, and data partitioning is optimized to improve the reliability of tree construction. 
                      Then, a phylogenetic tree is built using methods such as Maximum Likelihood, Bayesian Inference, or the Neighbor-Joining method. 
                      Finally, the phylogenetic tree is visualized to clearly display the evolutionary relationships.</p>
                    <p>Operation process in AMBER: <span class="kbd">Collection</span><strong> → </strong><span class="kbd">Alignment</span><strong> → </strong><span class="kbd">Trimming</span><strong> → </strong><span class="kbd">Integrate</span><strong> → </strong><span class="kbd">Model</span><strong> → </strong><span class="kbd">reconstruct</span></p>
                    <figure>
                      <img src="./images/howtouse/Phylogenetic_Analysis.png" alt="Phylogenetic_Analysis" data-lightbox>
                      <figcaption>Figure: Operation process in AMBER。</figcaption>
                    </figure>
                  </div>
                </div>
              </div>
              <h3>2.1 Collection</h3>
              <p>The imported data can be broadly categorized into two types: single-gene or multi-gene data, and genome-scale data. Single-gene and multi-gene datasets are typically generated through Sanger sequencing and correspond to specific, targeted DNA sequences. In contrast, genome-scale data are derived from whole-genome sequencing followed by assembly and annotation.</p>
              <div class="steps">
                <div class="step">
                  <div class="step-header">
                    <span class="step-num">1</span>
                    <span class="step-title">Collection of single-gene and multi-gene data</span>
                  </div>
                  <div class="step-body">
                    <p>AMBER supports direct import of raw sequencing files (.ab1) for both single-gene and multi-gene datasets, encompassing single or multiple DNA fragments. Based on predefined quality parameters, raw data can be automatically processed to generate high-confidence sequences, significantly reducing manual effort and improving both accuracy and consistency. Additionally, sequences in FASTA format can be imported. Data from online sources can be integrated via structured table files, and all acquired data are automatically merged into a unified dataset.</p>
                    <p>在菜单栏选择 <strong>文件 → 新建项目</strong>（或 <strong>打开项目</strong>）。为项目选择一个空目录，用于保存配置与输出文件。</p>
                    <figure>
                      <img src="./images/howtouse/collection_01.png" alt="Collection of single-gene and multi-gene data" data-lightbox>
                      <figcaption>Figure: Collection of single-gene and multi-gene data</figcaption>
                    </figure>
                  </div>
                  <div class="step-body">
                    <p><strong>(1) Import through Form</strong></p>
                    <p>表格文件准备。准备一个表格文件，第一行为列名。第一列和第二列的列名（第一行）需为表格中的，不可以更改。第三列以后列名为基因名，列中的数据为对应的NCBI ACCESSION号。AMBER将自动下载并整合数据。</p>
                    <figure>
                      <img src="./images/howtouse/collection_01_form.png" alt="Form Data" data-lightbox>
                      <figcaption>Figure: Accession Numbers in the Form</figcaption>
                    </figure>
                    <p>下载的文件为genbank文件，文件保存在download_data文件夹中，再次导入时则不需下载。可以将常用的文件保存在local_database文件夹中。当local_database中存在需要的数据时，则不会再下载，直接导入。</p>
                    <div class="callout info">此功能十分方便，可以手动下载保存，或者从其他地方拷贝。避免消耗时间重复下载文件</div>
                    <figure>
                      <img src="./images/howtouse/collection_01_download.png" alt="Sava Dat" data-lightbox>
                      <figcaption>Figure: Sava Data</figcaption>
                    </figure>
                  </div>
                  <div class="step-body">
                    <p><strong>(2) Import from Folder</strong></p>
                    <p>数据文件准备。将同一个基因的fasta文件放入同一个文件夹内，文件夹名称为基因名。文件夹中的fasta文件如果只有一个序列时，文件名为序列名称；如果fasta中有多条序列时，序列名使用fasta文件中的名称（>后的字符）；以此将文件整合在一起。</p>
                    <figure>
                      <img src="./images/howtouse/collection_01_datasets_form.png" alt="Import from Folder" data-lightbox>
                      <figcaption>Figure: Import from the Folder</figcaption>
                    </figure>
                  </div>
                  <div class="step-body">
                    <p><strong>(3) Datasets presentation</strong></p>
                    <p>从表格中导入序列的数据统计</p>
                    <figure>
                      <img src="./images/howtouse/collection_01_datasets_form.png" alt="Presentation of datasets from the form" data-lightbox>
                      <figcaption>Figure: Presentation of datasets from the form</figcaption>
                    </figure>
                    <p>从文件夹中导入序列的数据统计</p>
                    <figure>
                      <img src="./images/howtouse/collection_01_datasets_folder.png" alt="Presentation of datasets from the folder" data-lightbox>
                      <figcaption>Figure: Presentation of datasets from the folder</figcaption>
                    </figure>
                  </div>
                  <div class="step-body">
                    <p><strong>(4) Sequences presentation</strong></p>
                    <p>序列数据展示</p>
                    <figure>
                      <img src="./images/howtouse/collection_01_sequences.png" alt="sequences presentation" data-lightbox>
                      <figcaption>Figure: Sequences presentation</figcaption>
                    </figure>
                  </div>
                </div>
                <div class="step">
                  <div class="step-header">
                    <span class="step-num">2</span>
                    <span class="step-title">Collection of genomic data</span>
                  </div>
                  <div class="step-body">
                    <p></p>
                    <p>进入「数据」模块，点击 <strong>导入数据</strong>，选择支持的文件格式（如：FASTQ/CSV/JSON 等）。导入后会在数据表中显示摘要信息。</p>
                    <figure>
                      <img src="./images/howtouse/collection_02.png" alt="Collection of genomic data" data-lightbox>
                      <figcaption>Figure: Collection of genomic data</figcaption>
                    </figure>
                    <div class="callout info">可批量导入；重复导入会自动去重或提示覆盖（具体行为以设置为准）。</div>
                  </div>
                  <div class="step-body">
                    <p><strong>(1) Import through Form</strong></p>
                    <p>表格文件准备。准备一个表格文件，第一行为列名。第一列的列名（第一行）需为表格中的，不可以更改。第二列中的数据为对应的NCBI ACCESSION号。AMBER将自动下载并整合数据。</p>
                    <figure>
                      <img src="./images/howtouse/collection_02_form.png" alt="Form Data" data-lightbox>
                      <figcaption>Figure: Accession Numbers in the Form</figcaption>
                    </figure>
                    <p>下载的文件为genbank文件，文件保存在download_data文件夹中，再次导入时则不需下载。可以将常用的文件保存在local_database文件夹中。当local_database中存在需要的数据时，则不会再下载，直接导入。</p>
                    <div class="callout info">此功能十分方便，可以手动下载保存，或者从其他地方拷贝。避免消耗时间重复下载文件</div>
                    <figure>
                      <img src="./images/howtouse/collection_01_download.png" alt="Sava Dat" data-lightbox>
                      <figcaption>Figure: Sava Data</figcaption>
                    </figure>
                    <div class="callout info">可批量导入；重复导入会自动去重或提示覆盖（具体行为以设置为准）。</div>
                  </div>
                  <div class="step-body">
                    <p><strong>(2) Import from Folder</strong></p>
                    <p>数据文件准备。将所需提取数据的genbank文件放入文件夹内。若提取的nuclear genomes或prokaryotic genomes为genbank文件，每个taxon只能放在单独的genbank文件中。gff, gtf与tbl格式文件应为单独的taxon，导入时须有同名（扩展名不同的）fasta文件，否则无法导入。</p>
                    <figure>
                      <img src="./images/howtouse/collection_02_datasets_form.png" alt="Import from Folder" data-lightbox>
                      <figcaption>Figure: Import from the Folder</figcaption>
                    </figure>
                  </div>
                  <div class="step-body">
                    <p><strong>(3) Datasets presentation</strong></p>
                    <p>从表格中导入序列的数据统计</p>
                    <figure>
                      <img src="./images/howtouse/collection_02_datasets_form.png" alt="Presentation of datasets from the form" data-lightbox>
                      <figcaption>Figure: Presentation of datasets from the form</figcaption>
                    </figure>
                    <p>从文件夹中导入序列的数据统计</p>
                    <figure>
                      <img src="./images/howtouse/collection_02_datasets_folder.png" alt="Presentation of datasets from the folder" data-lightbox>
                      <figcaption>Figure: Presentation of datasets from the folder</figcaption>
                    </figure>
                  </div>
                  <div class="step-body">
                    <p><strong>(4) Sequences presentation</strong></p>
                    <p>序列数据展示</p>
                    <figure>
                      <img src="./images/howtouse/collection_01_sequences.png" alt="sequences presentation" data-lightbox>
                      <figcaption>Figure: Sequences presentation</figcaption>
                    </figure>
                  </div>
                </div>
              </div>

              <h3>2.2 Alignment</h3>
              <table class="kv">
                <tr><th>MAFFT</th><td>展示文件名、大小、导入时间、校验状态。</td></tr>
                <tr><th>MUSCLE</th><td>抽样预览前 N 行；可切换原始/解析视图。</td></tr>
                <tr><th>Clustal Omega</th><td>支持 MD5/SHA256；异常高亮并可重传。</td></tr>
              </table>
              <div class="steps">
                <div class="step">
                  <div class="step-header">
                    <span class="step-num">1</span>
                    <span class="step-title">MAFFT</span>
                  </div>
                  <div class="step-body">
                    <p>转到「分析」模块，选择预置模板或自定义参数。重要项示例：</p>
                    <ul>
                      <li>线程数/内存上限（影响性能与稳定性）；</li>
                      <li>分析模式（如：对齐 / 识别 / 报告）；</li>
                      <li>结果输出目录（默认为项目目录内的 <code>results/</code>）。</li>
                    </ul>
                    <figure>
                      <img src="./images/howtouse/Alignment_MAFFT.png" alt="MAFFT" data-lightbox>
                      <figcaption>Figure: Operation of MAFFT</figcaption>
                    </figure>
                  </div>
                </div>

                <div class="step">
                  <div class="step-header">
                    <span class="step-num">2</span>
                    <span class="step-title">MUSCLE</span>
                  </div>
                  <div class="step-body">
                    <p>点击 <strong>开始</strong>。任务面板会显示实时日志、进度条与估计剩余时间。可随时暂停/继续或取消。</p>
                    <figure>
                      <img src="./images/howtouse/Alignment_MUSCLE.png" alt="MUSCLE" data-lightbox>
                      <figcaption>Figure: Operation of MUSCLE</figcaption>
                    </figure>
                    <div class="callout tip">长任务建议勾选「完成后通知」，后台运行结束会弹出提醒。</div>
                  </div>
                </div>

                <div class="step">
                  <div class="step-header">
                    <span class="step-num">3</span>
                    <span class="step-title">Clustal Omega</span>
                  </div>
                  <div class="step-body">
                    <p>在「报告」模块查看图表与指标，支持导出为 <strong>HTML / PDF / PNG</strong>。可点击图例筛选数据系列、在图上框选缩放。</p>
                    <figure>
                      <img src="./images/howtouse/Alignment_ClustalOmega.png" alt="Clustal Omega" data-lightbox>
                      <figcaption>Figure: Operation of Clustal Omega</figcaption>
                    </figure>
                  </div>
                </div>
              </div>
              <h3>2.3 Trimming</h3>
              <table class="kv">
                <tr><th>TrimAl</th><td>展示文件名、大小、导入时间、校验状态。</td></tr>
                <tr><th>Gblocks</th><td>抽样预览前 N 行；可切换原始/解析视图。</td></tr>
              </table>
              <h3>2.4 Integrate</h3>
              <h3>2.5 Model</h3>
              <table class="kv">
                <tr><th>ModelFinder</th><td>展示文件名、大小、导入时间、校验状态。</td></tr>
                <tr><th>PartitionFinder</th><td>抽样预览前 N 行；可切换原始/解析视图。</td></tr>
              </table>
              <h3>2.6 Reconstruct</h3>
              <table class="kv">
                <tr><th>IQtree</th><td>展示文件名、大小、导入时间、校验状态。</td></tr>
                <tr><th>MrBayes</th><td>抽样预览前 N 行；可切换原始/解析视图。</td></tr>
                <tr><th>RAxML</th><td>支持 MD5/SHA256；异常高亮并可重传。</td></tr>
              </table>
              <h3>2.7 Treeverse</h3>
              <h3>2.8 Phylogenetic Agent</h3>
            </section>

            <!-- 3. Evolutionary Analysis -->
            <section>
              <h2>3. Evolutionary Analysis</h2>
              <h3>3.1 Molecular Evolution Analysis</h3>
              <table class="kv">
                <tr><th>项目信息</th><td>名称、路径、创建时间、最近修改。</td></tr>
                <tr><th>模板管理</th><td>保存/加载分析模板，便于复用参数。</td></tr>
                <tr><th>备份与恢复</th><td>一键压缩备份项目；崩溃后可自动恢复上次状态。</td></tr>
              </table>

              <h3>3.2 Population Genetics Analysis</h3>
              <table class="kv">
                <tr><th>数据列表</th><td>展示文件名、大小、导入时间、校验状态。</td></tr>
                <tr><th>预览</th><td>抽样预览前 N 行；可切换原始/解析视图。</td></tr>
                <tr><th>校验</th><td>支持 MD5/SHA256；异常高亮并可重传。</td></tr>
              </table>

              <h3>3.3 Community-Ecology Diversity</h3>
              <table class="kv">
                <tr><th>模式</th><td>对齐 / 调用 / 汇报（示例，按你的软件实际命名）。</td></tr>
                <tr><th>资源</th><td>线程、内存、临时目录、GPU（如有）。</td></tr>
                <tr><th>高级</th><td>阈值、过滤规则、重试策略、日志级别。</td></tr>
              </table>
              
            </section>

            <!-- 4. Gene Set Enrichment Analysis -->
            <section>
              <h2>4. Gene Set Enrichment Analysis (GSEA)</h2>
              <p>以下为默认快捷键，可在「设置 → 快捷键」中自定义：</p>
              <table class="kv">
                <tr><th>新建项目</th><td><span class="kbd">Ctrl/Cmd</span> + <span class="kbd">N</span></td></tr>
                <tr><th>打开项目</th><td><span class="kbd">Ctrl/Cmd</span> + <span class="kbd">O</span></td></tr>
                <tr><th>保存</th><td><span class="kbd">Ctrl/Cmd</span> + <span class="kbd">S</span></td></tr>
                <tr><th>开始/暂停任务</th><td><span class="kbd">Space</span> 或 <span class="kbd">K</span></td></tr>
                <tr><th>切换模块</th><td><span class="kbd">Ctrl/Cmd</span> + <span class="kbd">1..5</span></td></tr>
                <tr><th>搜索</th><td><span class="kbd">Ctrl/Cmd</span> + <span class="kbd">F</span></td></tr>
              </table>
              <div class="callout tip">多数列表支持方向键 ↑/↓ 选择，回车打开详情。</div>
              <h3>4.1 GO and KEGG</h3>
              <h3>4.2 Prerank GSEA</h3>
              <h3>4.3 GSEA</h3>
              <h3>4.4 ssGSEA</h3>
              <h3>4.5 GSVA</h3>
              <h3>4.6 Plotting</h3>
            </section>

            <!-- 5. NCBI -->
            <section>
              <h2>5. NCBI</h2>
              <div class="accordion" id="faq">
                <div class="ac-item">
                  <button class="ac-head">启动后界面空白或加载很慢</button>
                  <div class="ac-body">
                    <ul>
                      <li>检查显卡驱动与系统更新；</li>
                      <li>尝试在设置中关闭「硬件加速」；</li>
                      <li>删除缓存目录后重启软件。</li>
                    </ul>
                  </div>
                </div>
                <div class="ac-item">
                  <button class="ac-head">导入数据失败</button>
                  <div class="ac-body">
                    <ul>
                      <li>确认文件编码与扩展名正确；</li>
                      <li>查看「数据 → 校验」报错详情；</li>
                      <li>路径包含中文或空格时，建议移动到英文路径。</li>
                    </ul>
                  </div>
                </div>
                <div class="ac-item">
                  <button class="ac-head">任务长时间无进度</button>
                  <div class="ac-body">
                    <ul>
                      <li>在「分析 → 资源」降低线程/内存占用；</li>
                      <li>确保输出目录在本地 SSD；</li>
                      <li>查看状态栏错误图标并导出日志给我们。</li>
                    </ul>
                  </div>
                </div>
              </div>
            </section>

            <!-- 6. 反馈与支持 -->
            <section>
              <h2>6. Amber Agent</h2>
              <p>联系我们：<em>（填写你的邮箱/Issue 地址/QQ群/Slack/Discord）</em></p>
              <div class="callout warn">提交问题时请附上：软件版本、系统版本、复现步骤、关键截图与日志。</div>
            </section>
          </article>
        </div>
      </section>

      <!-- 其它栏目（保持） -->
      <section id="downloadContainer" class="content-section">
        <div class="card"><h3>Software</h3><p>……</p></div>
        <div class="card"><h3>Toolbox</h3><p>……</p></div>
      </section>

      <section id="exampleContainer" class="content-section">
        <div class="card"><h3>Phylogenetic Analysis Example</h3><p>……</p></div>
        <div class="card"><h3>Evolutionary Analysis Example</h3><p>……</p></div>
        <div class="card"><h3>Gene Set Enrichment Analysis Example</h3><p>……</p></div>
      </section>

      <section id="datasetContainer" class="content-section">
        <div class="card"><h3>Multi-gene</h3><p>……</p></div>
        <div class="card"><h3>Mitogenome</h3><p>……</p></div>
      </section>

      <section id="publicationContainer" class="content-section">
        <div class="card"><h3>Articles</h3><p>……</p></div>
      </section>

      <section id="contactContainer" class="content-section">
        <div class="card"><h3>Contact</h3><p>Email: </p></div>
        <div class="card"><h3>Location</h3><p>Address: No. 519, Kunzhou Road, Xishan District, Kunming City, Yunnan Province, China</p><p>Postal Code: 650118</p></div>
      </section>
    </main>

    <footer class="site-footer">
      <p>&copy; 2025 Guodong Lab. All rights reserved.</p>
    </footer>
  </div>

  <!-- ===== JS ===== -->
  <script>
    /* ========= 轮播 ========= */
    const slides = [
      { url:'./images/header/a01.png', title:'Phylogenetic Analysis', color:'rgba(36,31,33,.6)', alt:'Phylogenetic Analysis' },
      { url:'./images/header/a02.png', title:'Evolutionary Analysis', color:'rgba(43,35,26,.6)', alt:'Evolutionary Analysis' },
      { url:'./images/header/a03.png', title:'Gene Set Enrichment Analysis', color:'rgba(36,31,33,.6)', alt:'Gene Set Enrichment Analysis' },
      { url:'./images/header/a04.png', title:'NCBI', color:'rgba(43,35,26,.6)', alt:'NCBI' },
      { url:'./images/header/a05.png', title:'ABMER AGENT & PHYLOGENETIC AGENT', color:'rgba(36,31,33,.6)', alt:'ABMER AGENT & PHYLOGENETIC AGENT' },
      { url:'./images/header/a06.png', title:'TREEVERSE', color:'rgba(43,35,26,.6)', alt:'TREEVERSE' },
    ];
    const sliderEl = document.querySelector('.slider');
    const imgEl = document.querySelector('.slider-wrapper img');
    const titleEl = document.getElementById('sliderTitle');
    const footerEl = document.getElementById('sliderFooter');
    const nextBtn = document.querySelector('.next');
    const prevBtn = document.querySelector('.prev');
    const dots = Array.from(document.querySelectorAll('.slider-indicator li'));
    let idx=0, autoplayId=null; const AUTOPLAY=3000;
    function show(i){ idx=(i+slides.length)%slides.length; const s=slides[idx];
      imgEl.src=s.url; imgEl.alt='Slide: '+(s.alt||s.title); titleEl.textContent=s.title; footerEl.style.backgroundColor=s.color;
      document.querySelector('.slider-indicator li.active')?.classList.remove('active'); dots[idx]?.classList.add('active');
      dots.forEach((d,k)=>d.setAttribute('aria-selected',k===idx?'true':'false'));
    }
    function next(){ show(idx+1); } function prev(){ show(idx-1); }
    function start(){ stop(); autoplayId=setInterval(next,AUTOPLAY); }
    function stop(){ if(autoplayId){ clearInterval(autoplayId); autoplayId=null; } }
    function interacted(){ stop(); start(); }
    nextBtn.addEventListener('click', ()=>{ next(); interacted(); });
    prevBtn.addEventListener('click', ()=>{ prev(); interacted(); });
    dots.forEach((d,i)=>{ d.addEventListener('click', ()=>{ show(i); interacted(); }); d.addEventListener('keydown',e=>{ if(['Enter',' '].includes(e.key)){ e.preventDefault(); show(i); interacted(); } })});
    sliderEl.addEventListener('mouseenter', stop); sliderEl.addEventListener('mouseleave', start);
    let sx=0; sliderEl.addEventListener('touchstart',e=>{ sx=e.changedTouches[0].clientX; },{passive:true});
    sliderEl.addEventListener('touchend',e=>{ const dx=e.changedTouches[0].clientX-sx; if(Math.abs(dx)>40){ dx<0?next():prev(); interacted(); } },{passive:true});
    document.addEventListener('visibilitychange',()=>{ document.hidden?stop():start(); });
    show(0); start();

    /* ========= 路由切换 ========= */
    const navLinks=document.querySelectorAll('.navbar a');
    const sections=document.querySelectorAll('.content-section');
    const mobileSelect=document.getElementById('mobileNav');
    function switchTo(id){
      const cur=document.querySelector('.content-section.show');
      const tar=document.getElementById(id);
      if(!tar||cur===tar) return;
      cur?.classList.remove('fade-in'); cur?.classList.add('fade-out');
      setTimeout(()=>{ cur?.classList.remove('fade-out','show'); tar.classList.add('show'); setTimeout(()=>tar.classList.add('fade-in'),16); },180);
      document.querySelector('.navbar a.active')?.classList.remove('active');
      document.querySelector(`.navbar a[href="#${id}"]`)?.classList.add('active');
      if(mobileSelect && mobileSelect.value!==`#${id}`) mobileSelect.value=`#${id}`;
    }
    navLinks.forEach(a=>a.addEventListener('click',e=>{ e.preventDefault(); const id=a.getAttribute('href').slice(1); history.pushState({section:id},'',`#${id}`); switchTo(id); }));
    mobileSelect.addEventListener('change',function(){ if(!this.value) return; const id=this.value.slice(1); history.pushState({section:id},'',`#${id}`); switchTo(id); });
    function initByHash(){ const h=location.hash.slice(1)||'homeContainer';
      sections.forEach(s=>s.classList.remove('show','fade-in','fade-out'));
      document.querySelectorAll('.navbar a').forEach(a=>a.classList.remove('active'));
      document.querySelector(`.navbar a[href="#${h}"]`)?.classList.add('active');
      document.getElementById(h)?.classList.add('show','fade-in');
      if(mobileSelect) mobileSelect.value=`#${h}`;
    }
    window.addEventListener('load', initByHash);
    window.addEventListener('popstate', ()=>{ const h=location.hash.slice(1)||'homeContainer'; switchTo(h); });

    /* ========= GUI 手册增强：目录 / 高亮 / 灯箱 / FAQ ========= */
    (function manualEnhance(){
      const body = document.getElementById('manualBody');
      if(!body) return;

      // 1) h2/h3 自动 id
      const headings = body.querySelectorAll('h2, h3');
      const slugMap = new Map();
      const slugify = (t)=>{
        const base = (t||'section').trim().toLowerCase().replace(/[^\u4e00-\u9fa5\w\s\-]+/g,'').replace(/\s+/g,'-');
        if(!slugMap.has(base)){ slugMap.set(base,0); return base; }
        const n=slugMap.get(base)+1; slugMap.set(base,n); return `${base}-${n}`;
      };
      headings.forEach(h=>{ if(!h.id) h.id = slugify(h.textContent); });

      // 2) 构建 TOC
      const toc = document.getElementById('manualToc');
      const frag = document.createDocumentFragment();
      headings.forEach(h=>{
        if(!(h.tagName==='H2' || h.tagName==='H3')) return;
        const a=document.createElement('a'); a.href=`#${h.id}`; a.textContent=h.textContent; a.className = h.tagName==='H2' ? 'toc-l2' : 'toc-l3';
        a.addEventListener('click',(e)=>{ e.preventDefault(); document.getElementById(h.id)?.scrollIntoView({behavior:'smooth', block:'start'}); history.pushState(null,'',`#${h.id}`); });
        frag.appendChild(a);
      });
      toc.innerHTML=''; toc.appendChild(frag);

      // 3) 滚动高亮
      const tocLinks = Array.from(toc.querySelectorAll('a'));
      const spy = new IntersectionObserver((entries)=>{
        entries.forEach(en=>{
          const id=en.target.id; const link = tocLinks.find(a=>a.getAttribute('href')===`#${id}`);
          if(!link) return;
          if(en.isIntersecting){ tocLinks.forEach(n=>n.classList.remove('active')); link.classList.add('active'); }
        });
      }, { rootMargin:'0px 0px -70% 0px', threshold:0.1 });
      headings.forEach(h=>spy.observe(h));

      // 4) 图片灯箱：任意带 data-lightbox 的 <img>
      const lightbox = document.createElement('div');
      lightbox.className='lightbox';
      lightbox.innerHTML = '<span class="close" title="关闭">×</span><img alt="Preview">';
      document.body.appendChild(lightbox);
      const lbImg = lightbox.querySelector('img');
      const lbClose = lightbox.querySelector('.close');
      body.querySelectorAll('img[data-lightbox]').forEach(img=>{
        img.addEventListener('click', ()=>{
          lbImg.src = img.src;
          lightbox.classList.add('open');
        });
      });
      function closeLB(){ lightbox.classList.remove('open'); lbImg.src=''; }
      lbClose.addEventListener('click', closeLB);
      lightbox.addEventListener('click', (e)=>{ if(e.target===lightbox) closeLB(); });
      window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeLB(); });

      // 5) FAQ 折叠
      document.querySelectorAll('.accordion .ac-item').forEach(item=>{
        const head = item.querySelector('.ac-head');
        head.addEventListener('click', ()=> item.classList.toggle('open'));
      });

      // 6) 如果 URL 带有锚点，进入后平滑定位
      if(location.hash){
        const el = document.getElementById(location.hash.slice(1));
        el && setTimeout(()=>el.scrollIntoView({behavior:'smooth', block:'start'}), 200);
      }
    })();
  </script>
</body>
</html>
